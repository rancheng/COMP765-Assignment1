<launch>

<arg name="duration" default="30"/>

<arg name="RP" default="0.55"/>
<arg name="RD" default="0.0"/>
<arg name="RCONST" default="0.0"/>

<arg name="PP" default="2.0"/>
<arg name="PD" default="0.0"/>

<arg name="YP" default="-3.5"/>
<arg name="YI" default="0.0"/>
<arg name="YD" default="0.0"/>

<arg name="DP" default="-1.3"/>
<arg name="DD" default="0.0"/>

<!-- This starts the APs special depth filter and the logger -->
<include file="$(find aquaautopilot)/launch/auto_helpers.launch"/>

<!--The autopilot node itself --> 
<node pkg="aquaautopilot" type="local_autopilot_node" name="localAP">
       <remap from="/aqua/filtered_depth" to="/AP_filtered_depth"/>

       <param name="ROLL_P_GAIN" value="$(arg RP)"/>
       <param name="PITCH_P_GAIN" value="$(arg PP)"/>
       <param name="YAW_P_GAIN" value="$(arg YP)"/>
         
       <param name="YAW_I_GAIN" value="$(arg YI)"/>
        
       <param name="ROLL_D_GAIN" value="$(arg RD)"/>
       <param name="PITCH_D_GAIN" value="$(arg PD)"/>
       <param name="YAW_D_GAIN" value="$(arg YD)"/>
         
       <param name="ROLL_CONST_GAIN" value="$(arg RCONST)"/>
        
       <param name="KDEPTH"    value="$(arg DP)" />
       <param name="DEPTH_D_GAIN" value="$(arg DD)" />
       <param name="DEPTH_D_FILTER_PERIOD" value="0.6" />
</node>
 
<!-- Client to send continuous stream of commands -->
  <node pkg="aquaautopilot" type="grid_param_search_depth.py" name="grid_search_client" output="screen">
        <param name="duration" type="double" value="$(arg duration)"/>
        <param name="search_parameter" type="string" value="DEPTH_D_GAIN"/>
        <rosparam param = "val_options">[-0.1, -0.2, -0.4, -0.8, -1.6, -3.2]</rosparam>
  </node>
  
</launch>
